# Deploy TeamCity server on AWS

![](../img/teamcity_logo.png)

This template deploys TeamCity server and two separate machines with build agents installed.

- By default the setup uses the `t3.medium` based EC2 instances with Ubuntu 20.04 Focal Fossa amd64 based OS.
- Default region `us-east-1`

> `t3.medium` type of EC2 instance is in free tier, however you may experience performance issues. If you need better performance, consider switching to paid options of `m5.large` or `c5.large` type of instances.

For more information about AMI images available for Ubuntu in AWS region, see [Amazon EC2 AMI locator](https://cloud-images.ubuntu.com/locator/ec2/)

Delay is added after provisioning of EC2 instance with TeamCity server in order to get the `user_data` script finish installation and fully provision the machine. For more information about delay provider in Terraform, see [time_sleep resource](https://registry.terraform.io/providers/hashicorp/time/latest/docs/resources/sleep)

## SSH keys

SSH keys are generated by Terraform code and the private key is saved locally into `generated-ssh-key.pem` file.

## TeamCity server installation

TeamCity server installed via `user_data` script. For more information about installation, see "[Install TeamCity on Linux or MacOS](https://www.jetbrains.com/help/teamcity/install-teamcity-server-on-linux-or-macos.html)"

## Build agent installation and configuration

Build agents are run on separate EC2 instance machines via Docker containers. For more information, see [Agent Docker Images](https://www.jetbrains.com/help/teamcity/agent-docker-images.html). 

For more information about agent installation option, see [Install TeamCity agent](https://www.jetbrains.com/help/teamcity/install-teamcity-agent.html)

TeamCity agents can be connected to the TeamCity server via Agent Push option. For more information, see [Install via Agent Push](https://www.jetbrains.com/help/teamcity/install-teamcity-agent.html#Install+via+Agent+Push)

For agent configuration, see [Start TeamCity Agent](https://www.jetbrains.com/help/teamcity/start-teamcity-agent.html)